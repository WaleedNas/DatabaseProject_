@page "/Admin"
@inject NavigationManager navManager
@inject DataAccess.DBAccess.ISqlDataAccess db

<PageTitle>VBStore</PageTitle>
@if (notAdmin)
{
    <h1>Unauthorized Access</h1>
} else
{
<section class="slider_section">
    <div class="slider_container">
    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
        <div class="carousel-item active">
            <div class="container-fluid">
            <div class="row">
                <div class="col-md-7">
                <div class="detail-box">
                    
						<h1>
							Welcome @userModel.Fname
						</h1>
					
					
                    <a href="/contact">
                    Contact Us
                    </a>
                </div>
                </div>
                <div class="col-md-5 ">
                <div class="img-box">
                    <img src="images/slider-img.png" alt="" />
                </div>
                </div>
            </div>
            </div>
        </div>
        </div>
    </div>
    </div>
</section>

<section class="">
    Admin page
</section>
}


@code {
    int Id;
    User userModel = new User();
    IEnumerable<Book> books = new List<Book>();
    bool notAdmin = false;

    protected override async Task OnInitializedAsync()
    {
        var uri = new Uri(navManager.Uri);

        var queryString = uri.Query;

        if (!string.IsNullOrWhiteSpace(queryString))
        {
            Id = int.Parse(queryString.Substring(1));
            var userData = new UserData(db);
            userModel = await userData.GetUser(Id);
            if (userModel.Type == UserType.User)
            {
                notAdmin = true;
            }
        }

        var bookData = new BookData(db);
        books = await bookData.GetBooks();
    }

}
